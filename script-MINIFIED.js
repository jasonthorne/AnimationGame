for(var backgroundCanvas=document.getElementById("background"),basketCanvas=document.getElementById("basket"),apple1Canvas=document.getElementById("apple1"),apple2Canvas=document.getElementById("apple2"),apple3Canvas=document.getElementById("apple3"),apple4Canvas=document.getElementById("apple4"),apple5Canvas=document.getElementById("apple5"),canvasW=backgroundCanvas.width,canvasH=backgroundCanvas.height,backgroundCtx=backgroundCanvas.getContext("2d"),basketCtx=basketCanvas.getContext("2d"),appleCtxs=
[apple1Canvas.getContext("2d"),apple2Canvas.getContext("2d"),apple3Canvas.getContext("2d"),apple4Canvas.getContext("2d"),apple5Canvas.getContext("2d")],basketImgs=[],i=0;11>=i;i++)basketImgs[i]=new Image,basketImgs[i].src="img/baskets/basket"+i.toString()+".png";var backgroundImg=new Image;backgroundImg.src="img/background.png";
backgroundImg.onload=function(){backgroundCtx.drawImage(backgroundImg,0,0,canvasW,canvasH);basketCtx.drawImage(basketImgs[0],(canvasW-basketW)/2,canvasH-basketH-10,basketW,basketH);document.getElementById("timer").innerHTML="00";document.getElementById("score").innerHTML="00"};var key=[];window.addEventListener("keydown",function(a){key[a.keyCode]=!0});window.addEventListener("keyup",function(a){key[a.keyCode]=!1});Array.prototype.pickElement=function(){return this[Math.floor(Math.random()*this.length)]};
var basketW=110,basketH=basketW,Basket={img:function(){var a=new Image;a.src="img/baskets/basket0.png";return a}(),xPos:(canvasW-basketW)/2,yPos:canvasH-basketH-10,width:basketW,height:basketH,move:function(){key[37]?(this.xPos-=25,0>this.xPos&&(this.xPos=0)):key[39]&&(this.xPos+=25,this.xPos>canvasW-this.width&&(this.xPos=canvasW-this.width))}},apples=[],appleX=[120,273,518,632,720],appleY=[176,132,231,119,188],appleSpeeds=[6,9],applePauses=[1E3,2E3,3E3,4E3,5E3];
function Apple(a,b,h){this.img=function(){var a=new Image;a.src="img/apple.png";return a}();this.xPos=a;this.yPos=b;this.height=this.width=60;this.gravity=.3;this.bounce=.1;this.speed=appleSpeeds.pickElement();this.canFall=!1;this.canScore=!0;this.canFadeOut=!1;this.canFadeIn=!0;this.pauseTime=applePauses.pickElement();this.reset=function(){this.yPos=b;this.speed=appleSpeeds.pickElement();this.canScore=!0;this.canFadeOut=!1;this.canFadeIn=!0;this.pauseTime=progress+applePauses.pickElement()};this.fall=
function(){this.yPos+=this.speed;this.speed+=this.gravity;this.xPos<Basket.xPos+Basket.width&&this.xPos+this.width>Basket.xPos&&this.yPos<Basket.yPos+Basket.height&&this.yPos+this.height>Basket.yPos&&this.canScore&&(score++,10>score?(Basket.img.src=basketImgs[score].src,score="0"+score):Basket.img.src=0==score%2?basketImgs[10].src:basketImgs[11].src,document.getElementById("score").innerHTML=score,appleCtxs[h].globalAlpha=0,this.reset());this.yPos>=canvasH-10-this.height&&(this.canScore=!1,this.yPos=
canvasH-10-this.height,this.speed*=-this.bounce);-.05454545454545454==this.speed&&(this.canFall=!1,this.canFadeOut=!0)}}var start=0,progress=0,animationFrameRef=null;
function animate(a){start||(start=a);progress=a-start;backgroundCtx.clearRect(0,0,canvasW,canvasH);backgroundCtx.drawImage(backgroundImg,0,0,canvasW,canvasH);basketCtx.clearRect(0,0,canvasW,canvasH);Basket.move();basketCtx.drawImage(Basket.img,Basket.xPos,Basket.yPos,Basket.width,Basket.height);a=0;for(var b=apples.length;a<b;a++)progress<apples[a].pauseTime?apples[a].canFall=!1:apples[a].canFadeIn&&(appleCtxs[a].globalAlpha+=.05,.95<=appleCtxs[a].globalAlpha&&(apples[a].canFall=!0)),apples[a].canFall&&
apples[a].fall(),apples[a].canFadeOut&&(appleCtxs[a].globalAlpha-=.1,.01>=appleCtxs[a].globalAlpha&&apples[a].reset()),appleCtxs[a].clearRect(0,0,canvasW,canvasH),appleCtxs[a].drawImage(apples[a].img,apples[a].xPos,apples[a].yPos,apples[a].width,apples[a].height);animationFrameRef=requestAnimationFrame(animate)}var time=0;
function startTimer(){time=30;document.getElementById("timer").innerHTML=time;var a=setInterval(function(){time--;10>time&&(time="0"+time,document.getElementById("timer").style.color="#ff0000");0>=time&&(clearInterval(a),cancelAnimationFrame(animationFrameRef),showScoreModal());document.getElementById("timer").innerHTML=time},1E3)}var score=0,prevScore=0;
function startGame(){for(var a=0;5>a;a++){var b=new Apple(appleX[a],appleY[a],a);appleCtxs[a].globalAlpha=0;apples.push(b)}startTimer();requestAnimationFrame(animate)}var introModal=document.getElementById("intro-modal"),playBtn=document.getElementById("play-button");function showIntroModal(){introModal.style.display="block"}playBtn.onclick=function(){introModal.style.display="none";startGame()};var scoreModal=document.getElementById("score-modal"),replayBtn=document.getElementById("replay-button");
function showScoreModal(){scoreModal.style.display="block";document.getElementById("final-score").innerHTML=score;showScores()}replayBtn.onclick=function(){scoreModal.style.display="none";document.getElementById("score").innerHTML="00";document.getElementById("timer").style.color="#808080";prevScore=score;score=0;progress=start=apples.length=0;animationFrameRef=null;Basket.img.src=basketImgs[0].src;for(var a=document.getElementById("players-container");a.firstChild;)a.removeChild(a.firstChild);startGame()};
var currentPlayer="YOU";
function showScores(){function a(a,b){var c=document.createElement(a);c.className=b;return c}var b="test1 test2 test3 test4 test5 test6 test7 test8 test9 test10".split(" "),h=[25,3,20,40,99,54,63,5,78,15];b.push("YOU");h.push(50);b=b.map(function(a,b){return{name:a,score:h[b]}}).sort(function(a,b){return a.score<b.score?1:-1});console.log(b);for(var e=0,l=b.length;e<l;e++){var f=null;if("YOU"==b[e].name){f=a("div","current-player");var c=a("form","php-form");c.method="post";c.action="testPHP.php";
var d=a("input","save-button");d.type="button";d.value="yo";var g=a("div","save-button-container");g.appendChild(d);c.appendChild(g);d=a("input","name-input");d.type="text";d.placeholder="Enter name";g=a("div","current-player-score");g.appendChild(document.createTextNode(b[e].score));var k=a("div","testDiv");k.appendChild(d);k.appendChild(g);c.appendChild(k);f.appendChild(c)}else f=a("div","former-player"),c=a("div","former-player-name"),c.appendChild(document.createTextNode(b[e].name)),f.appendChild(c),
c=a("div","former-player-score"),c.appendChild(document.createTextNode(b[e].score)),f.appendChild(c);document.getElementById("players-container").appendChild(f)}};